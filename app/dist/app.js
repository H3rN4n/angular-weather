"use strict";angular.module("weatherModule",["geolocation","angularMoment","ui.bootstrap","ngTouch","ngAnimate","jtt_instagram"]),angular.module("weatherModule").controller("headerController",["$rootScope","$scope",function(e,t){e.showMenu={state:!1,"class":"ng-hide"},t.show=function(){e.showMenu.state?e.showMenu["class"]="animated slideOutUp":e.showMenu["class"]="animated slideInDown",e.showMenu.state=e.showMenu.state===!1}}]),angular.module("weatherModule").controller("listController",["$rootScope","placesFactory","geolocation",function(e,t,a){function n(e,a){a?t.addPlaceByCoords(a).then(function(e){r({goTo:0})}):(t.addPlaceByName(e).then(function(e){r()}),menu.newPlace="")}var o=this;o.active=0,o.initialPlaces=["Mendoza","Lima","San Francisco"],e.$on("updatePlaces",function(e,t){r()});var r=function(e){o.places=t.getPlaces(),o.places.length&&!e?o.active=o.places[o.places.length-1].id:o.active=e.goTo};o.initPlaces=function(){for(var e=0;e<o.initialPlaces.length;e++)t.addPlaceByName(o.initialPlaces[e]);a.getLocation().then(function(e){o.myCoords={lat:e.coords.latitude,"long":e.coords.longitude},n(null,o.myCoords)})}}]),angular.module("weatherModule").controller("menuController",["$rootScope","placesFactory",function(e,t){var a=this;a.places=t.getPlaces();a.addPlace=function(n,o){o||t.addPlaceByName(n).then(function(n){a.places=t.getPlaces(),a.newPlace="",e.$broadcast("updatePlaces",a.places)}),o&&t.addPlaceByCoords(o).then(function(n){a.places=t.getPlaces(),e.$broadcast("updatePlaces",a.places)})},a.removePlace=function(n){a.places=t.removePlace(n),e.$broadcast("updatePlaces",a.places)}}]),angular.module("weatherModule").directive("weatherMenu",[function(){return{restrict:"E",templateUrl:"./menu.html"}}]),angular.module("weatherModule").factory("openWeatherService",["$http",function(e){var t="af95bc4e30710dff7080cfb67eadba30",a="http://api.openweathermap.org/data/2.5/";return{getCurrentWeatherByCityName:function(n,o){return e({url:a+"weather",method:"GET",params:{q:n,appid:t,units:o||"metric"}})},getForecastWeatherByCityName:function(n,o){return e({url:a+"forecast/daily",method:"GET",params:{q:n,appid:t,units:o||"metric",cnt:6}})},getForecastWeatherByCoords:function(n,o){return e({url:a+"forecast/daily",method:"GET",params:{lat:n.lat,lon:n["long"],appid:t,units:o||"metric",cnt:6}})},getWeatherByCoords:function(n,o){return e({url:a+"find",method:"GET",params:{lat:n.lat,lon:n["long"],appid:t,units:o||"metric",cnt:2}})}}}]),angular.module("weatherModule").factory("placesFactory",["$q","openWeatherService","instagramFactory",function(e,t,a){var n=[],o=function(e){return t.getWeatherByCoords(e).then(function(t){return{coords:e,current:t}})},r=function(e){return t.getForecastWeatherByCoords(e.coords).then(function(t){return e.forecast=t,e})},c=function(e){return t.getCurrentWeatherByCityName(e).then(function(t){return{cityName:e,current:t}})},l=function(e){return t.getForecastWeatherByCityName(e.cityName).then(function(t){return e.forecast=t,e})},u=function(e){return a.getMediaByCoordinates({lat:e.current.data.coord.lat,lng:e.current.data.coord.lon,count:"1",access_token:"<YOUR_ACCESS_TOKEN>"}).then(function(t){return e.placeImage=t,console.log(e),e})};return{getPlaces:function(){return n},removePlace:function(e){return n=n.filter(function(t){return t.name!=e}),this.getPlaces()},addPlaceByCoords:function(e){return o(e).then(r).then(u)},addPlaceByName:function(e){return c(e).then(l).then(u)}}}]);